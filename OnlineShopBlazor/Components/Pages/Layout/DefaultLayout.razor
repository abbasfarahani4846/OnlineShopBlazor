@using Microsoft.AspNetCore.Components.Authorization
@inherits LayoutComponentBase
@inject IDbContextFactory<OnlineShopContext> DbContextFactory
@inject NavigationManager NavigationManager


@* <MudThemeProvider />
<MudPopoverProvider /> *@
<!--offcanvas menu area start-->
<div class="body_overlay">
</div>
<div class="offcanvas_menu">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="offcanvas_menu_wrapper">
                    <div class="canvas_close">
                        <a href="javascript:void(0)"><i class="ion-android-close"></i></a>
                    </div>
                    <div class="header_contact_info">
                        <ul class="d-flex">
                            <li class="text-white">
                                <i class="icons icon-phone"></i> <a href="tel:@Setting.Phone">
                                    @Setting.Phone
                                </a>
                            </li>
                            <li class="text-white">
                                <i class="icon-envelope-letter icons"></i>
                                <a href="#">
                                    @Setting.Email
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="header_social d-flex">
                        <span>Follow us</span>
                        <ul class="d-flex">
                            <li><a href="@Setting.Twitter"><i class="icon-social-twitter icons"></i></a></li>
                            <li><a href="@Setting.FaceBook"><i class="icon-social-facebook icons"></i></a></li>
                            <li><a href="@Setting.Instagram"><i class="icon-social-instagram icons"></i></a></li>
                            <li><a href="@Setting.Youtube"><i class="icon-social-youtube icons"></i></a></li>
                        </ul>
                    </div>
                    <div id="menu" class="text-left ">
                        <ul class="offcanvas_main_menu">

                            @foreach (var item in TopMenu)
                            {
                                <li class="menu-item-has-children">
                                    <a href="@item.Link">
                                        @item.Title
                                    </a>
                                </li>
                            }

                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--offcanvas menu area end-->
<!--mini cart-->
<div class="mini_cart">
</div>
<!--mini cart end-->
<!--header area start-->
<header class="header_section header_transparent">

    <div class="main_header">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="header_container d-flex justify-content-between align-items-center">
                        <div class="canvas_open">
                            <a href="javascript:void(0)"><i class="ion-navicon"></i></a>
                        </div>
                        <div class="header_logo">
                            <a class="sticky_none" href="/"><img src="/images/@Setting.Logo" alt="@Setting.Title"></a>
                        </div>
                        <!--main menu start-->
                        <div class="main_menu d-none d-lg-block">
                            <nav>
                                <ul class="d-flex">

                                    @foreach (var item in TopMenu)
                                    {
                                        <li>
                                            <a href="@item.Link">
                                                @item.Title
                                            </a>
                                        </li>

                                    }
                                </ul>
                            </nav>
                        </div>
                        <div class="header_account">
                            <ul class="d-flex">
                                <li class="header_search"><a><i class="icon-magnifier icons"></i></a></li>
                               <OnlineShopBlazor.Components.Pages.Common.UserMenuComponent/>
                                <li class="shopping_cart">
                                    <a href="#"><i class="icon-basket-loaded icons"></i></a>
                                    <span class="item_count">
                                        0
                                    </span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- page search box -->
    <div class="page_search_box">
        <div class="search_close">
            <i class="ion-close-round"></i>
        </div>


        <OnlineShopBlazor.Components.Pages.Common.SearchComponent />
    </div>

</header>

<!--header area end-->
@Body

<!--footer area start-->
<footer class="footer_widgets">
    <div class="container">
        <div class="row">
            <div class="col-lg-5 col-md-5 col-sm-5">
                <div class="footer_widget_list">
                    <div class="footer_logo">
                        <a href="/"><img src="/images/@Setting.Logo" alt="@Setting.Title"></a>
                    </div>
                    <div class="footer_contact">
                        <div class="footer_contact_list">
                            <span>Our Location</span>
                            <p>
                                @Setting.Address
                            </p>
                        </div>
                        <div class="footer_contact_list">
                            <span>24/7 hotline:</span>
                            <a href="tel:@Setting.Phone">
                                @Setting.Phone
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-7 col-md-7 col-sm-7">
                <div class="footer_widget_list text-right">
                    <div class="footer_menu">
                        <ul class="d-flex justify-content-end">

                            @foreach (var item in BottomMenu)
                            {
                                <li><a href="@item.Link">@item.Title</a></li>
                            }
                        </ul>
                    </div>
                    <div class="footer_social">
                        <ul class="d-flex justify-content-end">
                            <li>
                                <a href="@Setting.Twitter" data-tippy="Twitter" data-tippy-inertia="true"
                                   data-tippy-delay="50" data-tippy-arrow="true" data-tippy-placement="top">
                                    <i class="ion-social-twitter"></i>
                                </a>
                            </li>
                            <li>
                                <a href="@Setting.FaceBook" data-tippy="Facebook" data-tippy-inertia="true"
                                   data-tippy-delay="50" data-tippy-arrow="true" data-tippy-placement="top">
                                    <i class="ion-social-facebook"></i>
                                </a>
                            </li>
                            <li>
                                <a href="@Setting.GooglePlus" data-tippy="googleplus" data-tippy-inertia="true"
                                   data-tippy-delay="50" data-tippy-arrow="true" data-tippy-placement="top">
                                    <i class="ion-social-googleplus-outline"></i>
                                </a>
                            </li>
                            <li>
                                <a href="@Setting.Instagram" data-tippy="Instagram" data-tippy-inertia="true"
                                   data-tippy-delay="50" data-tippy-arrow="true" data-tippy-placement="top">
                                    <i class="ion-social-instagram-outline"></i>
                                </a>
                            </li>
                            <li>
                                <a href="@Setting.Youtube" data-tippy="Youtube" data-tippy-inertia="true"
                                   data-tippy-delay="50" data-tippy-arrow="true" data-tippy-placement="top">
                                    <i class="ion-social-youtube"></i>
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="copyright_right">
                        <p>
                            @Setting.CopyRight
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
<!--footer area end-->
@code {
    private Models.Db.Setting Setting { get; set; } = new();
    public List<Menu> TopMenu { get; set; } = new List<Menu>();
    public List<Menu> BottomMenu { get; set; } = new List<Menu>();

    protected override async Task OnInitializedAsync()
    {
        using var dbContext = DbContextFactory.CreateDbContext();
        // Fetch data using the DbContext
        Setting = await dbContext.Settings.FirstAsync();
        TopMenu = await dbContext.Menus.Where(x => x.Type == "Top").ToListAsync();
        BottomMenu = await dbContext.Menus.Where(x => x.Type == "Bottom").ToListAsync();
    }

}
